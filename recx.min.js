/*!
 * author:jieyou
 * see https://github.com/jieyou/recx
 */
!function(a){"function"==typeof define?define(a):"undefined"!=typeof KISSY?KISSY.add(a):"object"==typeof module&&module.exports?module.exports=a():window.recx=a()}(function(){function a(a){function b(){l.removeEventListener("DOMContentLoaded",b,!1),k.removeEventListener("load",b,!1),a.call(l)}"complete"===l.readyState?setTimeout(b):(l.addEventListener("DOMContentLoaded",b,!1),k.addEventListener("load",b,!1))}function b(a){var b=a.tagName;return b?b.toUpperCase():null}function c(a){return"string"==typeof a&&(a=l.getElementById(a)),a&&1===a.nodeType?a:l}function d(a){return"submit"!==a&&"button"!==a&&"hidden"!==a&&"image"!==a&&"file"!==a&&"reset"!==a}function e(a,b){if(a===b)return!0;if(a.compareDocumentPosition){if(20===a.compareDocumentPosition(b))return!0}else if(a.contains&&a.contains(b))return!0;return!1}function f(){var a;try{if(a=localStorage.getItem(n.getLocalStorageKeySuffix(m)))return a}catch(b){}return null}function g(a){var b,c,d,e,g=f(),h=[];if(g&&(c={},b=g.split("&"),q.call(b,function(a){var b=a.split("=");c[b[0]]=b[1]})),c)for(d in a)c[d]=a[d];else c=a;for(e in c)h.push(e+"="+c[e]);try{localStorage.setItem(n.getLocalStorageKeySuffix(m),h.join("&"))}catch(i){}}function h(a,c){var d=this;switch(c=c||{},d.wrapperDOM=a,d.handleSetValueFromCacheFuncs=c.handleSetValueFromCacheFuncs||{},d.ignoreIds=c.ignoreIds||[],d.afterSetValueFuncs=d.afterSetValueFuncs||{},b(d.wrapperDOM)){case"SELECT":d.selects=[a],d.textareas=[],d.inputs=[];break;case"TEXTAREA":d.selects=[],d.textareas=[a],d.inputs=[];break;case"INPUT":d.selects=[],d.textareas=[],d.inputs=[a];break;default:d.selects=a.getElementsByTagName("SELECT"),d.textareas=a.getElementsByTagName("TEXTAREA"),d.inputs=a.getElementsByTagName("INPUT")}}function i(a){a._changeEventFunc=function(c){var d,e,f=c.target,h=b(f),i=f.id;return i&&-1!==a.ignoreIds.indexOf(i)?!0:("SELECT"===h||"TEXTAREA"===h?e=!0:"INPUT"===h&&(d=f.type,d&&"text"!==d&&"checkbox"!==d&&"radio"!==d&&"password"!==d&&"range"!==d||(e=!0)),void(e&&g(a.getKvObj())))},a.wrapperDOM.addEventListener("change",a._changeEventFunc,!0),a._blurEventFunc=function(c){var e=c.target,f=b(e),h=e.id,i=e.type;return h&&-1!==a.ignoreIds.indexOf(h)?!0:void("INPUT"===f&&(i=e.type,i&&"text"!==i&&"checkbox"!==i&&"radio"!==i&&"password"!==i&&"range"!==i&&d(i)&&e.value!==e.getAttribute(n.oldValueAttributeName)&&(e.setAttribute(n.oldValueAttributeName,e.value),g(a.getKvObj()))))},a.wrapperDOM.addEventListener("blur",a._blurEventFunc,!0)}function j(b,d){var g,j=!1;if(b=c(b),r.call(p,function(a){return e(a,b)||e(b,a)?(j=!0,!0):void 0}),j)throw new Error("Specified `wrapperDOM` has been occupied or has been included by another occupied `wrapperDOM` or has another occupied `wrapperDOM` included.");return p.push(b),g=new h(b,d),a(function(){var a=f();a&&g.setValue(a),i(g)}),g}var k=window,l=document,m=location,n={noValueRadioIndexPrefix:"__R_NVRIP__",oldValueAttributeName:"data-roldvalue",textareaLineFeedHolder:"__R_TLFH_ramdom_769768842_ramdom_",getLocalStorageKeySuffix:function(a){var b="__R_LSK__"+a.pathname+a.search;return-1!==a.href.indexOf("#!")&&(b+=a.hash),b+="__",encodeURIComponent(b).substr(0,128)}},o="localStorage"in k,p=[],q=Array.prototype.forEach,r=Array.prototype.some;return o&&q&&r&&l.addEventListener&&l.removeEventListener?(h.prototype.setValue=function(a){var c=a.split("&"),f=this;q.call(c,function(a){var c,g,h,i,j,k,m,o=a.split("="),p=o[0],q=l.getElementById(p),s=o[1];q&&-1===f.ignoreIds.indexOf(p)&&e(f.wrapperDOM,q)&&(h=!0,k=f.handleSetValueFromCacheFuncs[p],"function"==typeof k&&(h=k.call(q,s,f.wrapperDOM)),h&&(c=b(q),"INPUT"===c?(g=q.type,"checkbox"===g?q.checked="1"===s:"radio"===g?(i=q.ownerDocument.getElementsByName(q.name),0===s.indexOf(n.noValueRadioIndexPrefix)?(s=parseInt(s.replace(n.noValueRadioIndexPrefix,"")),!isNaN(s)&&i[s]&&(i[s].checked=!0)):r.call(i,function(a){return a.value===s?(a.checked=!0,!0):void 0})):d(g)&&(q.setAttribute(n.oldValueAttributeName,s),q.value=s)):"TEXTAREA"===c?(q.setAttribute(n.oldValueAttributeName,s),q.value=s.replace(new RegExp(n.textareaLineFeedHolder,"g"),"\n")):"SELECT"===c?(j=q.getElementsByTagName("OPTION"),r.call(j,function(a,b){return a.value===s?(q.selectedIndex=b,!0):void 0})):q.value=s,m=f.afterSetValueFuncs,"function"==typeof m&&m.call(q,s,f.wrapperDOM)))})},h.prototype.getKvObj=function(){var a={},b=[],c=this;return q.call(c.selects,function(b){var d=b,e=d.id;e&&-1===c.ignoreIds.indexOf(e)&&(a[e]=d.value)}),q.call(c.textareas,function(b){var d=b,e=d.id;e&&-1===c.ignoreIds.indexOf(e)&&(a[e]=d.value.replace(/\n/g,n.textareaLineFeedHolder))}),q.call(c.inputs,function(e){var f,g,h,i=e,j=i.id,k=null,l=!1;j&&-1===b.indexOf(j)&&-1===c.ignoreIds.indexOf(j)&&(f=i.type,"checkbox"===f?k=i.checked?"1":"0":"radio"===f?(g=i.name,h=g?i.ownerDocument.getElementsByName(g):[i],q.call(h,function(a,c){a.checked&&!l&&(l=!0,k=a.getAttribute("value"),k||(k=n.noValueRadioIndexPrefix+c)),b.push(a.id)}),k||(k="")):d(f)&&(k=i.value),null!==k&&(a[j]=k))}),a},h.prototype.stop=function(){var a=this,b=a.wrapperDOM;b.removeEventListener("change",a._changeEventFunc,!0),b.removeEventListener("blur",a._blurEventFunc,!0),delete a._changeEventFunc,delete a._blurEventFunc,r.call(p,function(a,c){return a===b?(p.splice(c,1),!0):void 0})},j.customConfig=function(a){var b;for(b in a)a.hasOwnProperty(b)&&n.hasOwnProperty(b)&&typeof a[b]==typeof n[b]&&(n[b]=a[b])},j):function(){}});